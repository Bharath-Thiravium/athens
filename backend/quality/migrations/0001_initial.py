# Generated by Django 5.2.5 on 2025-08-29 05:23

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='QualityStandard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True)),
                ('version', models.CharField(max_length=20)),
                ('description', models.TextField()),
                ('requirements', models.JSONField(default=dict)),
                ('is_active', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='QualityMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('metric_date', models.DateField()),
                ('total_inspections', models.PositiveIntegerField(default=0)),
                ('passed_inspections', models.PositiveIntegerField(default=0)),
                ('failed_inspections', models.PositiveIntegerField(default=0)),
                ('pass_rate', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('total_defects', models.PositiveIntegerField(default=0)),
                ('critical_defects', models.PositiveIntegerField(default=0)),
                ('defect_density', models.DecimalField(decimal_places=4, default=0.0, max_digits=8)),
                ('supplier_performance', models.JSONField(default=dict)),
                ('prevention_costs', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('appraisal_costs', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('internal_failure_costs', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('external_failure_costs', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
            ],
            options={
                'ordering': ['-metric_date'],
                'unique_together': {('metric_date',)},
            },
        ),
        migrations.CreateModel(
            name='QualityTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('template_id', models.CharField(max_length=50, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('version', models.CharField(default='1.0', max_length=20)),
                ('industry', models.CharField(choices=[('solar_pv', 'Solar Photovoltaic'), ('solar_thermal', 'Solar Thermal'), ('wind_onshore', 'Wind Onshore'), ('wind_offshore', 'Wind Offshore'), ('energy_storage', 'Energy Storage'), ('grid_integration', 'Grid Integration'), ('hybrid_systems', 'Hybrid Systems')], max_length=16)),
                ('inspection_type', models.CharField(choices=[('incoming_inspection', 'Incoming Material Inspection'), ('in_process_inspection', 'In-Process Quality Control'), ('final_inspection', 'Final Product Inspection'), ('installation_qa', 'Installation Quality Assurance'), ('commissioning_test', 'Commissioning & Testing'), ('periodic_audit', 'Periodic Quality Audit'), ('supplier_audit', 'Supplier Quality Audit'), ('compliance_check', 'Regulatory Compliance Check')], max_length=35)),
                ('criticality', models.CharField(choices=[('low', 'Low Impact'), ('medium', 'Medium Impact'), ('high', 'High Impact'), ('critical', 'Mission Critical')], default='medium', max_length=10)),
                ('description', models.TextField()),
                ('scope', models.TextField()),
                ('prerequisites', models.JSONField(default=list)),
                ('compliance_requirements', models.JSONField(default=dict)),
                ('checklist_items', models.JSONField(default=list)),
                ('test_procedures', models.JSONField(default=list)),
                ('measurement_parameters', models.JSONField(default=dict)),
                ('acceptance_criteria', models.JSONField(default=dict)),
                ('failure_modes', models.JSONField(default=list)),
                ('risk_matrix', models.JSONField(default=dict)),
                ('mitigation_strategies', models.JSONField(default=dict)),
                ('required_roles', models.JSONField(default=list)),
                ('approval_workflow', models.JSONField(default=dict)),
                ('escalation_rules', models.JSONField(default=dict)),
                ('required_documents', models.JSONField(default=list)),
                ('photo_requirements', models.JSONField(default=dict)),
                ('signature_requirements', models.JSONField(default=list)),
                ('is_active', models.BooleanField(default=True)),
                ('is_certified', models.BooleanField(default=False)),
                ('certification_date', models.DateTimeField(blank=True, null=True)),
                ('next_review_date', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_templates', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='created_templates', to=settings.AUTH_USER_MODEL)),
                ('quality_standards', models.ManyToManyField(blank=True, to='quality.qualitystandard')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SupplierQuality',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('supplier_id', models.CharField(max_length=50, unique=True)),
                ('supplier_name', models.CharField(max_length=200)),
                ('supplier_code', models.CharField(max_length=50, unique=True)),
                ('supplier_type', models.CharField(choices=[('manufacturer', 'Manufacturer'), ('distributor', 'Distributor'), ('contractor', 'Contractor'), ('service_provider', 'Service Provider'), ('consultant', 'Consultant')], max_length=20)),
                ('industry', models.CharField(choices=[('solar_pv', 'Solar Photovoltaic'), ('solar_thermal', 'Solar Thermal'), ('wind_onshore', 'Wind Onshore'), ('wind_offshore', 'Wind Offshore'), ('energy_storage', 'Energy Storage'), ('grid_integration', 'Grid Integration'), ('hybrid_systems', 'Hybrid Systems')], max_length=16)),
                ('contact_person', models.CharField(blank=True, max_length=100)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone', models.CharField(blank=True, max_length=20)),
                ('address', models.TextField(blank=True)),
                ('website', models.URLField(blank=True)),
                ('quality_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('delivery_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('service_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('overall_rating', models.CharField(choices=[('A', 'A'), ('B', 'B'), ('C', 'C'), ('D', 'D')], max_length=1)),
                ('total_orders', models.PositiveIntegerField(default=0)),
                ('on_time_deliveries', models.PositiveIntegerField(default=0)),
                ('quality_incidents', models.PositiveIntegerField(default=0)),
                ('defect_rate', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('certification_status', models.CharField(choices=[('not_certified', 'Not Certified'), ('in_progress', 'Certification in Progress'), ('certified', 'Certified'), ('suspended', 'Suspended'), ('revoked', 'Revoked')], default='not_certified', max_length=15)),
                ('last_audit_date', models.DateField(blank=True, null=True)),
                ('next_audit_date', models.DateField(blank=True, null=True)),
                ('audit_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('audit_findings', models.JSONField(default=list)),
                ('certifications', models.JSONField(default=list)),
                ('compliance_records', models.JSONField(default=dict)),
                ('risk_assessment', models.JSONField(default=dict)),
                ('annual_revenue', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('employee_count', models.PositiveIntegerField(blank=True, null=True)),
                ('years_in_business', models.PositiveIntegerField(blank=True, null=True)),
                ('is_approved', models.BooleanField(default=False)),
                ('is_preferred', models.BooleanField(default=False)),
                ('approval_date', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-quality_score'],
            },
        ),
        migrations.CreateModel(
            name='QualityInspection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('inspection_id', models.UUIDField(default=uuid.uuid4, unique=True)),
                ('inspection_number', models.CharField(max_length=50, unique=True)),
                ('project_id', models.CharField(blank=True, max_length=100)),
                ('work_order_number', models.CharField(blank=True, max_length=100)),
                ('purchase_order_number', models.CharField(blank=True, max_length=100)),
                ('reference_number', models.CharField(max_length=100)),
                ('batch_number', models.CharField(blank=True, max_length=100)),
                ('serial_numbers', models.JSONField(default=list)),
                ('component_type', models.CharField(max_length=100)),
                ('component_model', models.CharField(blank=True, max_length=100)),
                ('manufacturer', models.CharField(blank=True, max_length=200)),
                ('quantity', models.PositiveIntegerField(default=1)),
                ('unit_of_measure', models.CharField(default='pcs', max_length=20)),
                ('latitude', models.DecimalField(blank=True, decimal_places=8, max_digits=10, null=True)),
                ('longitude', models.DecimalField(blank=True, decimal_places=8, max_digits=11, null=True)),
                ('location_name', models.CharField(blank=True, max_length=200)),
                ('site_conditions', models.JSONField(default=dict)),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent'), ('critical', 'Critical')], default='normal', max_length=10)),
                ('status', models.CharField(choices=[('scheduled', 'Scheduled'), ('ready', 'Ready to Start'), ('in_progress', 'In Progress'), ('on_hold', 'On Hold'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled'), ('rework_required', 'Rework Required'), ('under_review', 'Under Review'), ('approved', 'Approved'), ('rejected', 'Rejected')], default='scheduled', max_length=20)),
                ('overall_result', models.CharField(choices=[('pass', 'Pass'), ('fail', 'Fail'), ('conditional_pass', 'Conditional Pass'), ('rework_required', 'Rework Required'), ('deviation_approved', 'Deviation Approved'), ('waiver_granted', 'Waiver Granted')], default='pass', max_length=20)),
                ('checklist_results', models.JSONField(default=dict)),
                ('measurement_data', models.JSONField(default=dict)),
                ('test_results', models.JSONField(default=dict)),
                ('deviation_records', models.JSONField(default=list)),
                ('quality_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('defect_count', models.PositiveIntegerField(default=0)),
                ('critical_defect_count', models.PositiveIntegerField(default=0)),
                ('rework_count', models.PositiveIntegerField(default=0)),
                ('scheduled_date', models.DateTimeField()),
                ('planned_duration', models.DurationField(blank=True, null=True)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('actual_duration', models.DurationField(blank=True, null=True)),
                ('inspector_signature', models.JSONField(default=dict)),
                ('supervisor_signature', models.JSONField(default=dict)),
                ('customer_signature', models.JSONField(default=dict)),
                ('attachments', models.JSONField(default=list)),
                ('photos', models.JSONField(default=list)),
                ('certificates', models.JSONField(default=list)),
                ('calibration_records', models.JSONField(default=list)),
                ('compliance_status', models.JSONField(default=dict)),
                ('traceability_data', models.JSONField(default=dict)),
                ('inspector_notes', models.TextField(blank=True)),
                ('supervisor_comments', models.TextField(blank=True)),
                ('customer_feedback', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('inspector', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='inspections', to=settings.AUTH_USER_MODEL)),
                ('quality_manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='managed_inspections', to=settings.AUTH_USER_MODEL)),
                ('supervisor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='supervised_inspections', to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='quality.qualitytemplate')),
                ('supplier', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='quality.supplierquality')),
            ],
            options={
                'ordering': ['-scheduled_date'],
            },
        ),
        migrations.CreateModel(
            name='QualityAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_type', models.CharField(choices=[('defect_threshold', 'Defect Threshold Exceeded'), ('supplier_performance', 'Supplier Performance Issue'), ('compliance_violation', 'Compliance Violation'), ('inspection_overdue', 'Inspection Overdue'), ('certification_expiry', 'Certification Expiring'), ('quality_trend', 'Quality Trend Alert')], max_length=20)),
                ('severity', models.CharField(choices=[('info', 'Information'), ('warning', 'Warning'), ('critical', 'Critical'), ('urgent', 'Urgent')], max_length=10)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('is_acknowledged', models.BooleanField(default=False)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('inspection', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='quality.qualityinspection')),
                ('supplier', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='quality.supplierquality')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='QualityDefect',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('defect_id', models.CharField(max_length=50, unique=True)),
                ('defect_code', models.CharField(max_length=50)),
                ('category', models.CharField(choices=[('dimensional', 'Dimensional Non-Conformance'), ('visual', 'Visual Defect'), ('functional', 'Functional Issue'), ('performance', 'Performance Deviation'), ('safety', 'Safety Concern'), ('documentation', 'Documentation Issue'), ('packaging', 'Packaging Problem'), ('labeling', 'Labeling Error')], max_length=20)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('severity', models.CharField(choices=[('cosmetic', 'Cosmetic'), ('minor', 'Minor'), ('major', 'Major'), ('critical', 'Critical'), ('catastrophic', 'Catastrophic')], max_length=15)),
                ('location_details', models.CharField(blank=True, max_length=200)),
                ('affected_quantity', models.PositiveIntegerField(default=1)),
                ('root_cause', models.TextField(blank=True)),
                ('contributing_factors', models.JSONField(default=list)),
                ('failure_mode', models.CharField(blank=True, max_length=200)),
                ('immediate_action', models.TextField(blank=True)),
                ('corrective_action', models.TextField(blank=True)),
                ('preventive_action', models.TextField(blank=True)),
                ('target_completion_date', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('open', 'Open'), ('investigating', 'Under Investigation'), ('corrective_action', 'Corrective Action in Progress'), ('verification', 'Under Verification'), ('closed', 'Closed'), ('rejected', 'Rejected')], default='open', max_length=20)),
                ('is_resolved', models.BooleanField(default=False)),
                ('resolution_date', models.DateTimeField(blank=True, null=True)),
                ('verification_notes', models.TextField(blank=True)),
                ('cost_impact', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('schedule_impact', models.DurationField(blank=True, null=True)),
                ('customer_impact', models.TextField(blank=True)),
                ('photos', models.JSONField(default=list)),
                ('attachments', models.JSONField(default=list)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('action_owner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='owned_actions', to=settings.AUTH_USER_MODEL)),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resolved_defects', to=settings.AUTH_USER_MODEL)),
                ('inspection', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='defects', to='quality.qualityinspection')),
            ],
            options={
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['severity', 'status'], name='quality_qua_severit_8ea51b_idx'), models.Index(fields=['inspection', 'category'], name='quality_qua_inspect_41675f_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='qualitytemplate',
            index=models.Index(fields=['industry', 'inspection_type'], name='quality_qua_industr_416dce_idx'),
        ),
        migrations.AddIndex(
            model_name='qualitytemplate',
            index=models.Index(fields=['is_active', 'is_certified'], name='quality_qua_is_acti_305aa1_idx'),
        ),
        migrations.AddIndex(
            model_name='supplierquality',
            index=models.Index(fields=['overall_rating', 'is_approved'], name='quality_sup_overall_0639d5_idx'),
        ),
        migrations.AddIndex(
            model_name='supplierquality',
            index=models.Index(fields=['industry', 'supplier_type'], name='quality_sup_industr_0a9cf7_idx'),
        ),
        migrations.AddIndex(
            model_name='qualityinspection',
            index=models.Index(fields=['status', 'priority'], name='quality_qua_status_7674d1_idx'),
        ),
        migrations.AddIndex(
            model_name='qualityinspection',
            index=models.Index(fields=['scheduled_date', 'inspector'], name='quality_qua_schedul_fc4a40_idx'),
        ),
        migrations.AddIndex(
            model_name='qualityinspection',
            index=models.Index(fields=['overall_result', 'quality_score'], name='quality_qua_overall_d97588_idx'),
        ),
    ]
